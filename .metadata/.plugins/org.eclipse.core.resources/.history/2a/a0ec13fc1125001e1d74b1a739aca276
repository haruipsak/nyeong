package project;

public class DataBaseCon {
    Class.forName("org.h2.Driver");
    
    Connection conn = null; // DBMS와 Java연결객체
    Statement stmt = null; // SQL구문을 실행
    ResultSet rs = null; // SQL구문의 실행결과를 저장

    try
    {
	
	 String jdbcDriver = "jdbc:h2:tcp://localhost/~/pt";
     String query = "SELECT * FROM nyeong ORDER BY catfoodname";
     String sortColumn = request.getParameter("sort"); // 클라이언트에서 전달된 정렬 열 이름 받기
     String order = request.getParameter("order");
     // 만약 파라미터로 받은 정렬 열 이름이 존재한다면
     if(sortColumn !=null){
     	query = "SELECT * FROM nyeong ORDER BY " + sortColumn + " " + order;
     }


     // 2. 데이터베이스 커넥션 생성
     conn = DriverManager.getConnection(jdbcDriver);

     // 3. Statement 생성
     stmt = conn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);

     // 4. 쿼리 실행
     rs = stmt.executeQuery(query);
     
     
     
     
}catch(SQLException ex){
    out.println(ex.getMessage());
    ex.printStackTrace();
}finally{
    // 6. 사용한 Statement 종료
    if(rs != null) try { rs.close(); } catch(SQLException ex) {}
    if(stmt != null) try { stmt.close(); } catch(SQLException ex) {}

    // 7. 커넥션 종료
    if(conn != null) try { conn.close(); } catch(SQLException ex) {}
}
%>
}
